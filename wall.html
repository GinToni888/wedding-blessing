async function updateData() {
    try {
        const res = await fetch(`${GAS_URL}?t=${Date.now()}`);
        if (!res.ok) throw new Error("網路請求失敗");
        
        let data = await res.json();

        // 1. 如果 GAS 包裹了資料（例如回傳 { data: [...] }），則自動展開
        if (data.data && Array.isArray(data.data)) {
            data = data.data;
        }

        if (!Array.isArray(data) || data.length === 0) {
            document.getElementById('status-bar').innerText = "GAS 回傳資料格式錯誤或為空";
            return;
        }

        // 2. 自動診斷：輸出第一筆資料的欄位名稱到控制台 (F12)，方便您檢查
        console.log("收到資料範例:", data[0]);

        // 3. 強化過濾邏輯：同時檢查 'status'、'Status'、'審核狀態'
        const filtered = data.filter(m => {
            if (!m) return false;
            
            // 找出可能的狀態欄位值 (自動相容中英文標題)
            const val = m.status || m.Status || m.審核狀態 || m['審核狀態'];
            
            // 檢查是否為 'ok' (去除空白並轉小寫)
            return val && String(val).toLowerCase().trim() === 'ok';
        });

        if (filtered.length > 0) {
            messages = filtered;
            document.getElementById('status-bar').innerText = `同步成功: 已載入 ${messages.length} 則祝福`;
        } else {
            // 診斷回饋：如果沒找到 ok，告訴您目前抓到了哪些欄位
            const keys = Object.keys(data[0]).join(', ');
            document.getElementById('status-bar').innerText = `錯誤: 找不到 ok。請確認欄位名稱 (${keys})`;
        }
    } catch (e) {
        console.error("更新失敗:", e);
        document.getElementById('status-bar').innerText = "連線失敗，請檢查網路或 GAS 權限";
    }
}
